--- Blogging/db/db.script	2010-11-14 01:07:49.168957598 +0100
+++ blogging/db/db.script	2010-11-13 09:03:30.985133001 +0100
@@ -1,8 +1,19 @@
 CREATE SCHEMA PUBLIC AUTHORIZATION DBA
-CREATE MEMORY TABLE POST(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,AUTHOR VARBINARY(255),CONTENT LONGVARCHAR,CREATEDAT TIMESTAMP,HEADER LONGVARCHAR,STATUS CHAR(255) NOT NULL,TITLE VARCHAR(255))
-CREATE MEMORY TABLE USER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,ACTIVE BOOLEAN,AVATAR VARCHAR(255),BLOG VARCHAR(255),EMAIL VARCHAR(255),FIRSTNAME VARCHAR(255),LASTNAME VARCHAR(255),PASSWORD VARCHAR(255),ROLE VARCHAR(255),USERNAME VARCHAR(255))
-ALTER TABLE POST ALTER COLUMN ID RESTART WITH 1
-ALTER TABLE USER ALTER COLUMN ID RESTART WITH 9
+CREATE MEMORY TABLE CATEGORY(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,CREATEDAT TIMESTAMP,DESCRIPTION VARCHAR(255),POS INTEGER,STATUS VARCHAR(255),TITLE VARCHAR(255),AUTHOR_ID BIGINT)
+CREATE MEMORY TABLE POST(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,CONTENT LONGVARCHAR,CREATEDAT TIMESTAMP,HEADER LONGVARCHAR,STATUS VARCHAR(255),TITLE VARCHAR(255),AUTHOR_ID BIGINT,CATEGORY_ID BIGINT,CONSTRAINT FK260CC0FA266C1E FOREIGN KEY(CATEGORY_ID) REFERENCES CATEGORY(ID))
+CREATE MEMORY TABLE USER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,BLOG VARCHAR(255),EMAIL VARCHAR(255),FIRSTNAME VARCHAR(255),LASTNAME VARCHAR(255),PASSWORD VARCHAR(255),ROLE VARCHAR(255),STATUS VARCHAR(255),USERNAME VARCHAR(255))
+CREATE MEMORY TABLE USER_POST(USER_ID BIGINT NOT NULL,POSTS_ID BIGINT NOT NULL,CONSTRAINT SYS_CT_52 UNIQUE(POSTS_ID),CONSTRAINT FK8B9EA0947D03CECB FOREIGN KEY(POSTS_ID) REFERENCES POST(ID),CONSTRAINT FK8B9EA09447140EFE FOREIGN KEY(USER_ID) REFERENCES USER(ID))
+ALTER TABLE CATEGORY ADD CONSTRAINT FK6DD211EA7CD013E FOREIGN KEY(AUTHOR_ID) REFERENCES USER(ID)
+ALTER TABLE POST ADD CONSTRAINT FK260CC0A7CD013E FOREIGN KEY(AUTHOR_ID) REFERENCES USER(ID)
+ALTER TABLE CATEGORY ALTER COLUMN ID RESTART WITH 2
+ALTER TABLE POST ALTER COLUMN ID RESTART WITH 3
+ALTER TABLE USER ALTER COLUMN ID RESTART WITH 3
 CREATE USER SA PASSWORD ""
 GRANT DBA TO SA
 SET WRITE_DELAY 10
+SET SCHEMA PUBLIC
+INSERT INTO CATEGORY VALUES(1,'2010-10-05 11:49:00.000000000','all the last news from the blog world.',NULL,'a','News',1)
+INSERT INTO POST VALUES(1,'the default content for the first Post','2010-10-10 14:00:00.000000000','the header for the first post','p','My First Post',1,1)
+INSERT INTO POST VALUES(2,'the default content for the second from moderator Post','2010-10-10 14:00:00.000000000','the header for this second post','p','The second post from Moderator',2,1)
+INSERT INTO USER VALUES(1,'http://www.mcgivrer.fr/','frederic.delorme@web-context.com','Administrator','Blog manager','admin','administrator','a','admin')
+INSERT INTO USER VALUES(2,'http://www.mcgivrer.fr/','admin@web-context.com','Moderator','Blog publisher','moderator','moderator','a','moderator')
